2.背景
###2.1超文本传输协议
超文本传输协议（HTTP）是当今互联网上最常用的应用协议。
与许多网络协议一样，HTTP使用客户端-服务器模型。HTTP客户端打开与HTTP服务器的网络连接，并发送HTTP请求消息。然后，服务器用HTTP响应消息进行回复，该消息通常包含客户端请求的一些资源（文件、文本、二进制数据）。
为了方便您，我们在本节中简要介绍了HTTP消息的格式和结构。HTTP/1.1的详细规范可以在[RFC 2616-超文本传输协议-HTTP/1.1]中找到(https://tools.ietf.org/html/rfc2616).

###2.2 HTTP消息
HTTP消息是简单的格式化数据块。
所有HTTP消息分为两种类型：**请求**消息和**响应**消息。
*请求消息从web服务器请求操作。
*响应消息将请求的结果带回客户端。
请求和响应消息都具有相同的基本消息结构。

####2.2.1消息格式
HTTP请求和响应消息由3个组件组成：
-描述消息的起始行，
-包含属性的报头块，
-以及包含数据的可选主体。
每个组件的格式如下

#####2.2.1.1起始线
所有HTTP消息都以一行开始。请求消息的起始行显示“要做什么”。响应消息的起始行显示“发生了什么”。
具体而言，起始行在*请求消息*中也称为***请求行***，在*响应消息*中称为***响应行***。
***请求行**
*包含一个描述服务器应该执行什么操作的方法和一个描述在其上执行该方法的资源的请求URL。
*还包括一个HTTP版本，告诉服务器客户端说的是什么HTTP方言。所有这些字段都用空格分隔。
*例如`GET/index.html HTTP/1.1`
***响应线**
*包含响应消息正在使用的HTTP版本、数字状态代码和描述操作状态的文本原因短语。
*例如`HTTP/1.1 200 OK`

#####2.2.1.2集管
开始行后面是一个包含0、1或多个HTTP头字段的列表。
HTTP头字段为请求和响应消息添加附加信息。它们基本上只是名称/值对的列表。
每个HTTP标头都有一个简单的语法：一个名称，后面跟着冒号“：”，后面跟着可选的空白，后面跟着字段值，后面跟着“CRLF”。
HTTP标头分为：
*常规标题
*请求标头
*响应标头
*实体标头
*扩展标头。
请注意，请求标头字段与响应标头字段不同。我们不会详细介绍这些领域，也不需要您在这个实验室中实现。
你可以在[RFC 2616-超文本传输协议-HTTP/1.1]中找到它们(https://tools.ietf.org/html/rfc2616).
请求中的标头示例：
```
主机：127.0.0.1:8888
用户代理：Mozilla/5.0（X11；Ubuntu；Linux x86_64；rv:74.0）Gecko/20100101 Firefox/74.0
接受：text/html，application/xhtml+xml，application/xml；q=0.9，图像/web，*/*；q=0.8
接受语言：en-US，en；q=0.5
接受编码：gzip，deflate
连接：保持活动
升级不安全请求：1
缓存控制：最大年龄=0
//CRLF
```
响应中的标头示例：
```
服务器：郭的Web服务器
内容长度：248
内容类型：text/html
//CRLF
```
#####2.2.1.3主体
HTTP消息的第三部分是可选的实体主体。实体体是HTTP消息的有效负载。它们是HTTP设计用来传输的东西。
HTTP消息可以携带多种数字数据：图像、视频、HTML文档、软件应用程序、信用卡交易、电子邮件等等。
实体实体示例：
```
<html>＜头＞
<title=CS06142</title=
</head><body>
<h1>CS06142</h1>
<p>欢迎参加云计算课程<br/>
</p>
<小时>
<address>位于ip-127-0-0-1端口8888的Http服务器</address>
</body></html>
```

####2.2.2 HTTP请求的结构
HTTP请求消息包含：
*HTTP请求行：
方法
*查询字符串，
*HTTP协议版本，
*零个或多个HTTP头行，
*空行（即“CRLF”本身），
*请求需要携带的可选内容。
HTTP请求消息示例：
```
获取/index.html HTTP/1.1
主机：127.0.0.1:8888
用户代理：Mozilla/5.0（X11；Ubuntu；Linux x86_64；rv:74.0）Gecko/20100101 Firefox/74.0
接受：text/html，application/xhtml+xml，application/xml；q=0.9，图像/web，*/*；q=0.8
接受语言：en-US，en；q=0.5
接受编码：gzip，deflate
连接：保持活动
升级不安全请求：1
缓存控制：最大年龄=0
//CRLF

####2.2.3 HTTP响应的结构
HTTP响应消息包含：
*HTTP响应状态行：
*HTTP协议版本，
*状态代码
*状态代码的描述），
*零个或多个HTTP头行，
*空行（即“CRLF”本身）
*HTTP请求所请求的内容。
HTTP响应消息示例：
```
HTTP://1.1 200 OK
服务器：微型Web服务器
内容长度：248
内容类型：text/html
//CRLF
<html>＜头＞
<title=CS06142</title=
</head><body>
<h1>CS06142</h1>
<p>欢迎参加云计算课程<br/>
</p>
<小时>
<address>位于ip-127-0-0-1端口8888的Http服务器</address>
</body></html>
```
“主机”请求头指定请求发送到的服务器的主机和端口号。如果不包括端口，则隐含所请求服务的默认端口（例如，443表示HTTPS URL，80表示HTTP URL）。
“内容长度”标头指示发送给收件人的邮件正文的大小（以字节为单位）。
“内容类型”表示标头用于指示资源的原始媒体类型。
以下是一些例子：
|文件扩展名|MIME类型|
| --- | --- |
|*.html|text.html|
|*.js|text/javascript|
|*.css | text/css|
|*.txt|text/plain|
|*.json|application/json|
|*.png|image/png|
|*.jpg|image.jpg|

###2.3 HTTP代理
HTTP代理服务器是中介。代理位于客户端和服务器之间，充当“中间人”，在各方之间来回移动HTTP消息。
HTTP代理服务器是代表客户端完成事务的中间商。在没有HTTP代理的情况下，HTTP客户端直接与HTTP服务器对话。使用HTTP代理，客户端转而与代理进行通信，代理本身代表客户端与服务器进行通信。
HTTP代理服务器既是web服务器又是web客户端。因为HTTP客户端向代理发送请求消息，所以代理服务器必须像web服务器一样正确处理请求和连接并返回响应。同时，代理本身向服务器发送请求，因此它也必须像正确的HTTP客户端一样发送请求和接收响应。
HTTP代理的工作模式如下图所示：
```
+-----------+               +-----------+
|           |               |           |
+----------+请求||请求||
|          |+--------------->           |+-------------->           |
|客户端||代理||服务器|
|          <---------------+|           <--------------+|           |
+----------+响应||响应||
|           |               |           |
+-----------+               +-----------+
```

##2.4 JSON
JSON（JavaScript Object Notation）是一种轻量级的数据交换格式。人类读写很容易。机器很容易解析和生成。它基于JavaScript编程语言标准ECMA-262第三版（1999年12月）的子集。JSON是一种完全独立于语言的文本格式，但使用C族语言程序员熟悉的约定，包括C、C++、C#、Java、JavaScript、Perl、Python和许多其他语言。这些属性使JSON成为一种理想的数据交换语言。
JSON建立在两个结构上：
*名称/值对的集合。在各种语言中，这被实现为对象、记录、结构、字典、哈希表、键控列表或关联数组。
*值的有序列表。在大多数语言中，这是以数组、向量、列表或序列的形式实现的。
这些都是通用的数据结构。几乎所有现代编程语言都以这样或那样的形式支持它们。与编程语言可互换的数据格式也基于这些结构，这是有道理的。
在JSON中，它们采用以下形式：
*对象是一组无序的名称/值对。对象以“｛”开头，以“｝”结尾。每个名称后面跟有“：”，名称/值对之间用“，”分隔。
*数组是值的有序集合。数组以“[”开头，以“]”结尾。值用“，”分隔。
*值可以是双引号中的字符串、数字、true、false或null、对象或数组。这些结构可以嵌套。
*字符串是一个由零个或多个Unicode字符组成的序列，用双引号括起来，使用反斜杠转义。一个字符被表示为单个字符串。字符串非常像C或Java字符串。
*数字非常像C或Java数字，只是没有使用八进制和十六进制格式。
*空白可以插入任何一对令牌之间。除了一些编码细节外，这完全描述了该语言。
例如
```json
{
地位
“代码”：200，
“text”：“确定”
},
数据
{
“id”：“S1”，
“name”：“Foo”
},
“条形图\r\n”，
5.0,
是的，
无效的
]
}
```

##2.5卷曲
`curl`是一种使用支持的协议之一（DICT、FILE、FTP、FTPS、GOPHER、HTTP、HTTPS、IMAP、IMAPS、LDAP、LDAPS、MQTT、POP3、POP3S、RTMP、RTMPS、RTSP、SCP、SFTP、SMB、SMBS、SMTP、SMTPS、TELNET和TFTP）从服务器传输数据或向服务器传输数据的工具。该命令被设计为在没有用户交互的情况下工作。
`curl`提供了大量有用的技巧，如代理支持、用户身份验证、FTP上传、HTTP post、SSL连接、cookie、文件传输恢复、Metalink等。正如你将在下面看到的，功能的数量会让你大吃一惊！
`curl`由libcurl提供所有与传输相关的功能。有关详细信息，请参见libcurl（3）。
###2.5.1源代码
您可以查看最新的[源代码](https://github.com/curl/curl)来自GitHub。
###2.5.2安装
在许多操作系统上，默认情况下已经安装了curl。如果没有，你可以使用系统的包管理工具来安装它。例如，Ubuntu的“sudo-apt-install-ccurl”。
###2.5.3教程
欲了解更多教程，请查看[卷曲教程](https://curl.se/docs/manual.html)或安装后使用“man curl”。
在这里，我们给出一些你可能需要在实验室中使用的例子。
####2.5.3.1获取
#####访问静态资源
壳
curl-i-X GEThttp://localhost:8080/index.html
```
#####访问web服务
壳
curl-i-X GEThttp://localhost:8080/api/search
```
######带有查询字符串
壳
curl-i-G-d“id=1&name=Foo”-X GEThttp://localhost:8080/api/search
```
#####2.5.3.2岗位
#####发送数据，如html＜form/＞
壳
curl-i-d'id=1&name=Foo'
-H'内容类型：应用程序/x-www-form-urlencoded'
-X柱http://localhost:8080/api/upload
```
#####发送数据使用表单数据
壳
curl-i-F“id=1”-F“name=Foo”
-X柱http://localhost:8080/api/upload
```
#####使用json发送数据
壳
curl-i-d'｛“id”：“1”，“name”：“Foo”｝'
-H'内容类型：application/json'
-X柱http://localhost:8080/api/upload
